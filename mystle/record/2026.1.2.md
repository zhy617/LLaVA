(llava) root@sharing-windsor-1119-6c84fb7697-6pmbk:~/LLaVA#  cd /root/LLaVA ; /usr/bin/env /root/miniconda3/envs/llava/bin/python /root/.vscode-server/extensions/ms-python.debugpy-2025.18.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher 34029 -- /root/LLaVA/mystle/eval_pictures.py 
/root/miniconda3/envs/llava/lib/python3.10/site-packages/torch/cuda/__init__.py:51: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
Flash Attention 2 is available. Setting it as default for Llama.
[2026-01-02 14:08:01,708] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
/root/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/root/miniconda3/envs/llava/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.57s/it]
Resetting model state for new scene: b789de07180846cc972118ee6d1fb027
===== Processing Scene: b789de07180846cc972118ee6d1fb027 =====
--- Processing Key Frame: 02c431d3d810472d9307d91e77fe495f ---
/root/miniconda3/envs/llava/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:397: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `None` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Model Output: The image shows a rainy day with a gloomy atmosphere. The road appears wet, reflecting the overcast sky. The ego vehicle is a dark-colored SUV, and it is positioned in the middle of the road, facing towards the right side of the image. There are no pedestrians visible in the image.

Key factors for driving planning include:

1. The ego vehicle is the only vehicle in the immediate vicinity, with no other cars or obstacles visible.
2. There are no traffic lights or pedestrians in the image.
3. The road appears to be clear, with no visible obstacles or hazards.

Predictions for the ego vehicle's behavior:

1. The ego vehicle will continue to drive straight ahead, as there are no visible obstacles or turns to make.
2. The driving speed will likely be slow due to the wet road conditions, which can increase the risk of hydroplaning.
3. The driver will need to be cautious and maintain a safe distance from the vehicle in front of them, as the road appears to be empty and visibility might be reduced due to the rain.

--- Processing Key Frame: 13ade121714c46d6a028516ecb5bff60 ---
[-24.451812744140625, -17.911195755004883, -13.386053085327148, -21.121938705444336, -11.30759048461914, -18.969011306762695, -19.911951065063477, -12.142489433288574, -12.469433784484863, -11.532770156860352, -19.477458953857422, -17.76837730407715, -16.332015991210938, -17.595508575439453]
Model Output: In this image, taken from the perspective of the car's front camera, there are several key factors for driving planning:
1. There is a pedestrian visible on the far right side of the image. The pedestrian is crossing the street diagonally from the right side of the frame towards the left.
2. There is a white van approaching from the left side of the image, moving towards the intersection. The van is larger and appears closer to the camera, suggesting closer proximity to the driving perspective.
3. A construction crane is raised over the street intersection, which is a notable obstacle. The crane has a silver color and indicates construction or repair work in the area.
4. There is a traffic light just visible at the far left side of the image, slightly obscured by the camera angle. The rest of the street appears to be clear with no other vehicles or pedestrians visible.

Given these factors, the ego vehicle's behavior would likely depend on its programming and the road conditions at the time. On the current evidence alone, the ego vehicle could continue straight, turn left in response to the pedestrian crossing, or turn right to avoid the approaching van. The vehicle's speed would depend on its speed limits, local traffic conditions, and the road conditions. Slower speeds would be more appropriate in this situation, given the pedestrian crossing and the presence of a construction area where there might be workers or obstacles requiring additional caution.

--- Processing Key Frame: 39961df49391439fbca612a8efe1c531 ---
[-1.2542102336883545, -10.244630813598633, -8.796242713928223, -10.791001319885254, -3.7995612621307373, -6.202577114105225, -11.526895523071289, -12.294474601745605, -13.972248077392578, -11.79860782623291, -9.99496078491211, -14.830133438110352, -15.384735107421875, -16.984375, -6.187870502471924, -8.780227661132812, -13.307272911071777, -10.831104278564453, -11.697087287902832, -4.2906999588012695, -4.426517963409424, -12.12806510925293, -5.997458457946777, -5.743556022644043, -6.1927995681762695, -11.289161682128906, -12.725606918334961, -12.838074684143066]
Model Output: **Description:**

Main Road: Gray paved street with white lane dividers. The road is wide with no parked vehicles and appears to be mostly clear. A pedestrian is visible in the distance, walking on the right side of the road.

Off Road: The lower part of the image shows a sidewalk, which runs parallel to the main road. The sidewalk shows a slight incline and curves to the left.

Obstacles: Some objects are visible in the center of the image, but it's not clear what they are. Also, a truck appears to be moving in the opposite direction on the main road.

Key Factor: The sidewalk merges with a red building at the bottom left corner of the image, suggesting that the road might continue straight or make a left turn.

Predicted Behavior:

- Turn Right: The ego vehicle seems to be planning to merge with the road beyond the red building, indicating that it should turn right.

- Driving Speed: It's uncertain from the image alone. However, since the main road appears clear and no significant obstacles or intersections are currently visible, it might accelerate to the least amount necessary should the road continue straight.

Please note that these predictions are based on the visible data in the image and driving scenarios can be affected by more information that is obstructed or not visible in the image.

--- Processing Key Frame: 690c4ddabc7845f48f4831ac73129154 ---
[-13.0283203125, -1.3556381464004517, -5.240555763244629, -2.786375045776367, -7.646384239196777, -3.0020594596862793, -5.624374866485596, -0.12584207952022552, -10.30226993560791, -13.276005744934082, -4.842723846435547, -11.614861488342285, -11.508906364440918, -14.07628059387207, -20.356624603271484, -3.093332290649414, -13.877025604248047, -3.946885585784912, -15.591693878173828, -15.78127670288086, -20.351327896118164, -19.251598358154297]
Model Output: - There are two vehicles in the frame: one white car in the left lane or possibly traveling under an overpass, and another pedestrian crossing the street to the right of the first vehicle.
- There are red traffic lights in the distance which could be seen from the perspective of the front camera but not from inside the car. The position of the traffic lights indicates an intersection ahead.
- A green dumpster is prominently visible on the right side of the image. Its position might indicate that it's probably parked on the side of a road and not currently obstructing traffic.
- The obstacle that you can describe is a tall fence beside the building, which could be part of a specific area or a barrier to safety. It does not seem obstruct the view of the road.

Predicting behavior:
Given these observations, it appears that the ego vehicle needs to come to a complete stop at the red traffic lights ahead. The vehicle will follow traffic regulations as long as it is safe to proceed with other vehicles and pedestrians at the intersection. Once it has stopped, it will wait for the lights to change and proceed with caution, following the correct path indicated by the two white arrows on the road.

--- Processing Key Frame: b0e6fd5561454b2789c853e5350557a8 ---
[-12.874259948730469, -1.3266953229904175, -4.491203784942627, -11.368367195129395, -16.2536678314209, -12.490599632263184, -3.79571533203125, -9.561883926391602, -10.901723861694336, -7.986152172088623, -15.034684181213379, -7.135509014129639, -10.805463790893555, -3.6738247871398926, -6.615357398986816, -10.788259506225586, -10.438000679016113, -4.070122241973877, -18.687023162841797, -25.675983428955078, -10.16191291809082, -7.345287322998047, -15.87594985961914, -14.791144371032715, -10.945396423339844, -6.787445068359375, -14.05058479309082, -17.124183654785156, -1.5773646831512451, -7.022345542907715, -13.773321151733398, -18.89574432373047, -12.91329288482666, -22.76253890991211, -9.318319320678711, -5.926688194274902, -11.131758689880371, -9.077071189880371, -8.1065673828125, -13.541407585144043, -10.851020812988281, -11.739313125610352, -4.236513137817383, -3.4865078926086426]
Model Output: ![](https://kokomountilson.github.io/files/share.jpg):::
:::The scene captured has a focused on the road and the environment. Key factors for driving planning include::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::~

--- Processing Key Frame: c4b8c55ceed44c7e95c36e61b8a99ffe ---
[-15.567273139953613, -10.443195343017578, -11.475661277770996, -8.675580024719238, -11.255270004272461, -16.024066925048828, -11.327810287475586, -13.323774337768555, -16.12430763244629, -18.300487518310547, -1.4770539999008179]
Model Output: On the left, a car parked under an overcast sky, with a garage visible behind it. The road is predominantly grey in color, both the road and the sidewalk. There is a yellow garbage can on the sidewalk. A blue and silver building with many windows in the background, suggesting a commercial or office area. Overcast sky throughout the scene. The ego vehicle, facing the camera, is approaching, driving towards the foreground, with other vehicles parked beyond. There are no visible pedestrians or traffic lights on the road. The vehicle has the option to turn left, with other cars parked along the side.

Behavior prediction: Ego vehicle will continue to drive straight towards the camera, maintaining its speed. The vehicle will encounter an obstacle in the form of the other parked cars, which are in its path. The ego vehicle will need to decide if it needs to move closer or leave additional space for its intended trajectory. It would be a good idea to check the exhaust or air vents for overheating defects and possibly a radiator and transmission fluids. If these air vents are closed or blocked, they might need to be removed, especially if the air conditioning unit is out.

Resetting model state for new scene: 41fde20fedcd4d22ab26811688612870
===== Processing Scene: 41fde20fedcd4d22ab26811688612870 =====
--- Processing Key Frame: 23e7d17b256348638af3b2739b80a5ca ---
Model Output: The image shows a wide, two-lane road with a green median in the middle. The road is lined with trees and there are buildings on both sides. The sky is overcast, and the lighting suggests it might be early morning or late afternoon.

On the left side of the road, there is a car parked near the sidewalk. On the right side, there is a building with a sign that reads "Wessex." There are no pedestrians visible in the image.

The traffic lights are not visible in the image. There are no other vehicles in the image, which suggests that the road is not busy at this time.

Given the image, the ego vehicle should proceed straight ahead. The driving speed should be normal, as there are no obstacles or pedestrians to slow down for. The road appears to be clear and safe for driving.

--- Processing Key Frame: 2c1f8867c60b44f09ee37b5df1d1ad24 ---
[-24.352880477905273, -17.63606834411621, -13.580947875976562, -20.758758544921875, -10.856514930725098, -10.751653671264648, -13.046286582946777, -17.726682662963867, -18.247905731201172, -18.306461334228516, -12.034895896911621, -11.805070877075195, -11.109016418457031, -10.976696968078613, -13.068700790405273, -14.934639930725098, -13.433259010314941, -19.485597610473633, -17.414762496948242]
Model Output: Obstacles:
- The leading vehicle is a small tour bus on the road ahead.
- There is a bicycle parked next to a fence next to the sidewalk.
- The sidewalk is to the left of the bus and appears to be empty.
- There are trees to the right of the vehicle, which could obstruct vision.
- Traffic lights are present but not clearly visible.

Movements of vehicles:
- The ego vehicle is moving forward and is currently following the bus.
- There is slow traffic as indicated by the driver's attentiveness and reaction to the bus.

Pedestrians:
- There are no pedestrians visible in the image.

Traffic lights:
- They are not clearly visible but should be accounted for in the driving planning.

Prediction:
The ego vehicle will continue to follow the leading bus, adjusting its speed and trajectory based on the traffic conditions and the bus's movements. The driver will be cautious as there is a parked bicycle alongside the vehicle, which may require extra care when maneuvering in case of any sudden actions from the bicycle owner or officer. The driver must be aware of the presence of trees on the side of the road, as they could present obstacles by suddenly getting in the vehicle's path. The driver will need to stay alert for traffic lights to navigate smoothly and safely through the road, considering the ongoing traffic and whether the traffic lights are currently favorable for the ego vehicle.

--- Processing Key Frame: 4de7963785f34de7afb9e5aae3ce6f9f ---
[-12.941362380981445, -1.445058822631836, -5.888538837432861, -12.312623977661133, -13.773527145385742, -18.102937698364258, -5.318262577056885, -13.231203079223633, -9.460448265075684, -14.230663299560547, -4.327231407165527, -10.303237915039062, -10.842658042907715, -7.853616237640381, -7.350465774536133, -1.7776814699172974, -10.535075187683105, -10.28610610961914, -7.283166885375977, -10.483510971069336, -1.3728764057159424]
Model Output: h

The driving scene depicts a quiet road, lined with trees and buildings. The sky above is overcast, suggesting dreary weather conditions. A large sign for a media circle indicates a correction an intersection is up ahead. The road curves slightly to the right after the sign.

No other vehicles are currently visible on the road, which appears to be devoid of traffic at this time. A pedestrian is visible on the far right side of the road, walking along the curb.

There are no significant obstacles or hazards in the drivers' view. Traffic lights are visible ahead and off to the side, their colors indicating the current state of the intersection. The ego vehicle, being a car, should proceed through the intersection at a safe speed without concerns for other vehicles or pedestrians.

--- Processing Key Frame: a32eb5c0d8514895af2af5889c1f5199 ---
[-20.42603874206543, -1.4591405391693115, -2.855797290802002, -2.532522201538086, -7.71016263961792, -2.2806131839752197, -14.698373794555664, -18.544111251831055, -17.17049217224121, -12.007843017578125, -10.583608627319336, -3.1958703994750977, -1.416444182395935, -4.075529098510742, -18.72620964050293, -13.890270233154297, -11.48949146270752, -11.901311874389648, -16.383758544921875, -11.58552360534668]
Model Output: The image shows a scene from the perspective of a car's front cameras. The road is straight and the car is approaching an intersection. The primary obstacle is ahead, and it appears to be a roundabout. The nearest roundabout appears to be empty. Ahead, there is a white building with a red roof and an additional building with a flat roof and a chimney. The scene includes trees, a fence, and the sky is overcast. There is a sign in the foreground but it's not clear from this distance or angle.

:

Based on this observation, the ego vehicle should prepare to enter the roundabout at a slow speed, yielding to any traffic already within the circle. Upon entering, the vehicle should maintain a safe speed, adapting to the speed of the other vehicles in the roundabout. After completing the roundabout, the car should regulate its speed according to the visible traffic conditions and maintain a safe following distance from the car(s) in front, observed and inferred from the visible image. Behavior should not deviate from standard safe driving practices and no abrupt maneuvers should be attempted.

Resetting model state for new scene: 1aa633b683174280b243e0a9a7ad9171
===== Processing Scene: 1aa633b683174280b243e0a9a7ad9171 =====
--- Processing Key Frame: 0791e7e86b98473795eeffe238d6c13b ---
Model Output: The image shows a wide, tree-lined street with a clear view of the road ahead. There are no immediate obstacles or pedestrians visible in the image. The traffic lights are not clearly visible, but there are no visible traffic lights in the image.

The ego vehicle is currently stationary, likely at an intersection or a stop sign. The road ahead appears to be clear, with no visible traffic or obstacles.

Given the current state of the image, the ego vehicle should proceed straight or turn right, depending on the traffic rules at this intersection. The driving speed should be normal, as there are no indications of an emergency or a need to slow down.

--- Processing Key Frame: a82c0acb18dd4c3a99731b7a06a63fb7 ---
[-24.7866268157959, -17.6733455657959, -12.977787971496582, -20.4532527923584, -11.175540924072266, -10.241863250732422, -13.087578773498535, -16.078353881835938, -18.60393714904785, -20.335487365722656, -13.266397476196289, -12.36453628540039, -10.846989631652832, -10.624323844909668, -12.474115371704102, -13.316303253173828, -10.70946216583252, -13.106621742248535, -10.314167976379395, -17.122549057006836]
Model Output: appears to be a pedestrian walking on the footpath on the right side of the street. They are carrying a bag and seem to be in motion towards the camera. The person might be entering or exiting parking or alighting from a vehicle or heading to work
::traffic lights are not visible in the image::
::no vehicles are behind the ego vehicle on the road::
::the traffic light nearest the ego vehicle is not visible::
::trees can be seen in the background, indicating a suburban area::
::the sky appears overcast::
::visibility seems to be good::
::the road seems to be calm::
::the ego vehicle appears to be moving towards the right side of the road::
::the ego vehicle is currently stopped::
::cruise control is still engaged::
::speed of the vehicle is 0 KPH::

--- Processing Key Frame: c0ac3dc491e7414184f44c2b32d24ad8 ---
[-19.026695251464844, -15.196966171264648, -9.97420597076416, -10.590886116027832, -9.350098609924316, -8.495711326599121, -14.080820083618164, -13.375798225402832, -20.838788986206055, -3.023041248321533, -8.953320503234863, -5.990146636962891, -13.571908950805664, -15.059163093566895, -8.963872909545898, -6.717222213745117, -2.4584827423095703, -6.098387241363525, -9.282400131225586, -9.31536865234375, -12.765617370605469]
Model Output: image: This is a black and white photograph of a city street. The photo captures a long straight road with a wide median. There is a tall building to the left side, in front of which is parked a car. In the drive-through lane on the right, there is a vehicle ready to go through the tunnel. A sidewalk is visible alongside the street. In the distance, traffic can be observed, and there is a bicycle lane to the left. The sky is partial, with some natural light streaming around a cloud. There is a bright green tree to the right of the vehicle in the drive-through lane, providing some contrast to the otherwise industrial scene. Overall, this image depicts a typical street scene with a car waiting for an opening, pedestrian areas, and other vehicles, both moving and stationary. The forecasted ego vehicle behavior would be to drive straight at the current traffic speed.

--- Processing Key Frame: d21bdffbca9f4edaa4bf4f54fffa6f4b ---
[-16.68756866455078, -8.680670738220215, -10.629569053649902, -6.558635234832764, -9.56414794921875, -11.931913375854492, -12.644662857055664, -13.985546112060547, -19.906295776367188, -10.883282661437988, -11.144824981689453, -10.280069351196289, -1.456316351890564, -10.73284912109375]
Model Output: The image captures a clear view of a two-lane road with visible traffic. The ego vehicle is currently paused at a red traffic light in the foreground. To the left of this intersection, there is an upright small tree with thick foliage. On the right side of the photo is green, possibly indicating grass or trees.

In the road ahead, there is a small white sedan driving in the same direction as the ego vehicle. Further behind is a larger car, also abiding by the traffic light. On the far right and at a considerable distance, there is a pedestrian crossing. There are no other vehicles in the immediate vicinity that are so close to the ego vehicle.

The buildings visible in the background suggest a commercial or residential area. There is a line of trees in the distance, adding to the serene suburban setting.

Based on the image, the ego vehicle should proceed with caution, especially given the presence of pedestrians who may be crossing the road. The speed of the ego vehicle should be slow, allowing for a safe crossing for the pedestrian. When given the green light, it should continue at a slower, safe driving speed to account for the small trees and possibly the presence of pedestrians or cyclists in these areas. Turns to the right should be aborted at the road curves to avoid going out of sight of the pedestrians and to maintain safety.

--- Processing Key Frame: e42c40288fba48e993507ce35215a7d5 ---
[-0.48900967836380005, -8.894947052001953, -10.500645637512207, -17.791048049926758, -19.105642318725586, -13.602703094482422, -2.811674118041992, -12.478680610656738, -10.641688346862793, -7.434521198272705, -13.646332740783691, -13.844131469726562, -16.023609161376953, -10.936494827270508, -9.26095199584961, -3.4089674949645996, -11.238239288330078]
Model Output: description: The image shows a tree-lined street with two cars parked along the side of the road. The sky is overcast, and the time on the clock visible in the image is not clear.

There is a sidewalk on the left side of the image lined with green vegetation. A traffic light appears to be glowing red in the distance. The road itself is clear in this section, with no immediate obstacles or extremely slow-moving traffic. The ego vehicle is driving on the correct side of the road, lining up correctly for the upcoming traffic light.

Prediction of behavior: Considering the current speed and following distance of the ego vehicle, based on the following requirements of safe driving and traffic rules, the ego vehicle should slow down to a normal speed and prepare to yield to its right for any emerging traffic, especially if pedestrians are at the crossing or an oncoming vehicle is approaching from a side street, which is not the case in this image. If such conditions were present, the ego vehicle should stop and yield the right of way to the vehicles or pedestrians as required by law.

Reached the limit of 3 scenes. Stopping.