(llava) root@sharing-windsor-1119-6c84fb7697-6l5c4:~/LLaVA#  cd /root/LLaVA ; /usr/bin/env /root/miniconda3/envs/llava/bin/python /root/.vscode-server/extensions/ms-python.debugpy-2025.18.0-linux-x64/bundled/libs/debugpy/adapter/../../debugpy/launcher 36917 -- /root/LLaVA/mystle/eval_pictures.py 
/root/miniconda3/envs/llava/lib/python3.10/site-packages/torch/cuda/__init__.py:51: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
Flash Attention 2 is available. Setting it as default for Llama.
[2026-01-03 09:00:47,165] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
/root/miniconda3/envs/llava/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/root/miniconda3/envs/llava/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████| 3/3 [00:04<00:00,  1.60s/it]
Resetting model state for new scene: b789de07180846cc972118ee6d1fb027
===== Processing Scene: b789de07180846cc972118ee6d1fb027 =====
--- Processing Key Frame: 02c431d3d810472d9307d91e77fe495f ---
/root/miniconda3/envs/llava/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:397: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `None` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Model Output: The driving scene appears to be in a city area, possibly near an industrial or commercial area given the presence of a large building and a parking lot. The road is wet, suggesting recent rain, which could affect visibility and traction.

Key factors for driving planning include:

1. The presence of a large building on the right side of the road, which might limit visibility around the corner.
2. A parking lot with several cars parked, which could be entering or exiting the lot, potentially causing traffic flow changes.
3. A truck parked on the side of the road, which could be obstructing the view of oncoming traffic.
4. A pedestrian crossing visible on the right side of the road, indicating the need to be cautious of pedestrians.
5. A traffic light visible on the left side of the road, which could be controlling the flow of traffic.

Predictions for ego vehicle behavior:

1. The ego vehicle should approach the intersection with caution, as there might be oncoming traffic from the large building or the parking lot.
2. The ego vehicle should be prepared to slow down or stop if necessary to yield to pedestrians crossing the road.
3. The ego vehicle should be aware of the traffic light and follow the signal accordingly.
4. The ego vehicle should be prepared to turn left or right, depending on the traffic flow and the presence of any obstacles or pedestrians.
5. The ego vehicle should maintain a safe speed, considering the wet road conditions and the presence of other vehicles and pedestrians.

--- Processing Key Frame: 13ade121714c46d6a028516ecb5bff60 ---
[-25.30984115600586, -18.029315948486328, -13.423733711242676, -12.127915382385254, -18.393585205078125, -15.653569221496582, -11.956937789916992, -12.423336029052734, -11.99760913848877, -10.802852630615234, -13.671098709106445, -13.719034194946289, -11.88408374786377, -13.705801963806152, -12.500274658203125, -11.338343620300293, -13.71284294128418, -13.131697654724121, -14.889755249023438, -18.470706939697266, -10.140459060668945, -19.96106719970703, -13.186735153198242, -12.429506301879883, -12.010546684265137, -14.156122207641602, -11.145025253295898, -11.918972969055176, -17.78936004638672, -19.233474731445312, -11.790838241577148, -15.493365287780762]
Model Output: Before providing a description, for the back-right camera's image, you've shared, I need to process this image in a way that preserves relevant license plate details, as this information is crucial for analysis. Please allow me a little more time to ensure accuracy.

Assuming the license plates are visible in the back-right camera's image:

Description with key factors:
- The main elements visible are a brown shingled building with parking, a drive-through lane for a large establishment not identified, a high building in the distance, another tall building with a rotating crane, and multiple road signs.
- There are orange and yellow cones along the building's boundary, which might signal roadwork or construction activities.
- The driving scene includes a variety of vehicle types and sizes, possibly indicating a dense urban environment with mixed traffic.
- Pedestrian activity appears low to moderate.
- Traffic light situations are not explicitly visible, but presence of cones and the high level of vehicle activity might suggest the need to be cautious at intersections or on curves where traffic lights can't be directly identified.

Upon analyzing the additional image provided, the license plates are indeed visible:

License plates present and identifiable.

Predicting the behavior of the ego vehicle based on this image:

- The ego vehicle should consider being cautious at locations requiring such precautionary cones due to potential roadwork or construction activities.
- Speed should be adjusted accordingly to maintain driving rhythm with the congested traffic.
- Road signs should be adhered to as there may be specific directions to follow.

Driving direction prediction:
Given the high building with a rotating crane in the distance, you'd need to be prepared to adjust your driving direction in accordance with the movement of the crane, which may involve zigzagging or carefully turning due to the temporary alignment disturbances.

Predicted driving direction and speed:
Since the image shows many cars in drive using their body language or trucks and construction activities, it seems like a heavy traffic, slower speeds are required in the following external might be required Care should be taken into account the heavy traffic conditions.

--- Processing Key Frame: 39961df49391439fbca612a8efe1c531 ---
[-9.141040802001953, -13.624578475952148, -7.987255573272705, -7.755862712860107, -13.964068412780762, -6.32988166809082, -4.602428436279297, -11.417317390441895, -12.797188758850098, -8.521662712097168, -12.735666275024414, -10.145963668823242, -15.877279281616211, -14.54691219329834, -9.368507385253906, -4.876662731170654, -14.794333457946777, -12.51830768585205, -15.544986724853516, -11.426047325134277, -10.822460174560547, -10.977258682250977, -12.97812271118164, -16.36088752746582, -13.519129753112793, -8.663671493530273, -5.2055745124816895, -6.197876930236816, -9.47010612487793, -12.958654403686523, -12.628374099731445, -18.549043655395508, -23.376296997070312, -8.55904483795166, -12.509462356567383, -7.335129261016846, -4.320549964904785, -3.990494966506958, -8.297287940979004, -9.734790802001953, -0.7870769500732422, -11.603845596313477, -19.108448028564453, -23.1077823638916, -15.620699882507324, -11.806146621704102]
Model Output: In the given images, the following is observed:

1. **Driving Scene**: The scene displays a clear pavement road with a vehicle parked on the far right side. The area is characterized by a flat landscape with some buildings and power lines in the vicinity. There is no evidence of artificial obstacles, such as median strips, on the road itself, but there could be pedestrian and vehicle traffic based on the patterns visible.

2. **Key Factors for Driving Planning**:
   - Presence of Obstacles: None immediately evident in the given images which would require navigation around, except for the car parked on the side where that car may be a factor.
   - Vehicles and Pedestrians: There are no visible vehicles beyond the parked car or pedestrians crossing the road.
   - Traffic Lights: Their presence is not clear from this angle of the vehicle's camera but would need a full set of pictures around the rings for traffic lights to function properly.

3. **Predictions for Ego Vehicle**:
   - Driving Direction: As the current location of the ego vehicle suggests it's continuing straight or possibly following a starboard turn as the next maneuver.
   - Driving Speed: As the clear road ahead with no visible obstacles or traffic, the ego vehicle can operate at a faster speed without significant concern. However, this is a prediction, and actual driving conditions will always dictate the best action.

--- Processing Key Frame: 690c4ddabc7845f48f4831ac73129154 ---
[-2.2065815925598145, -8.340452194213867, -12.657894134521484, -5.924747467041016, -10.28256607055664, -9.57951545715332, -11.573424339294434, -11.567720413208008, -8.653282165527344, -12.50424861907959, -9.427632331848145, -0.006020979955792427, -3.352419853210449, -11.465343475341797]
Model Output: The image shows a driving scene with multiple camera perspectives. Here's a description of the driving scene, key factors for driving planning, and predictions for the ego vehicle's behavior:

Key factors for driving planning:

1. Parked cars: There are multiple parked cars in the scene, all aligned along the driver's side.
2. Traffic light: A traffic light is visible in the scene, indicating an intersection or some controlled traffic conditions.
3. Road condition: The road appears to be wet, which could affect driving conditions, especially on curves.
4. Curb condition: The curb is visible, with a slight incline.

Predictions for the ego vehicle:

1. Driving direction: The ego vehicle is likely to proceed straight, as it looks like clear lane and traffic ahead, if granted, could potentially make this direction desirable.
2. Driving speed: Due to the wet and possibly rainy conditions, the ego vehicle's speed should be adjusted to a safer speed, such as slow to slowish, maintaining awareness of any slippery patches, additional time needed for braking due to weather, and other vehicles and pedestrians that need to be considered in the vicinity.

Please note that I am an AI and the predictions are based on the information provided and the current image, which may not fully capture the complexity of a real-world driving situation.

--- Processing Key Frame: b0e6fd5561454b2789c853e5350557a8 ---
[-0.5137361884117126, -8.916773796081543, -16.654754638671875, -10.654496192932129, -10.401581764221191, -3.210103750228882, -13.567654609680176, -13.028501510620117, -12.932768821716309, -4.836999893188477, -18.239837646484375, -20.3359375, -20.875001907348633]
Model Output: The driving scene depicted in these images is on an overcast day, as indicated by the gloomy lighting and fading colors. The streets seem to be mainly empty, with the main activity being stationary vehicles. There are large buildings visible on both sides of the road, indicating an urban setting possibly in a commercial or industrial area.

Six cameras are attached to the vehicle:

- Front: Clear view of the road ahead but no immediate obstacles, save for a few cars and a truck.
- Front-Left: No immediate obstacles, just parts of the buildings and cars, nothing significant.
- Front-Right: A clear view of nothing but sky, indicating a drive without change in direction.
- Back: Buildings and a truck in the view, with a change of scenery but no immediate obstacles.
- Back-Left: Wider view showing building details and cars, including a metal warehouse building.
- Back-Right: More of the same, but with a view into the open sky instead of the back of the vehicle.

Predictions for ego vehicle behavior:
Given that this is a stationary scenario with no immediate obstacles, a driver could proceed in any direction without encountering hazards, but given the condition of the lighting and the narrow spaces, it might be advisable to maintain a slower speed.

- The specific behavior of the ego vehicle would depend on the driver's actions and objectives.

Follow-up image request:
If you provide a specific action that the ego vehicle could take next, such as accelerating, slowing down, or turning, I can describe the next images and update the behavior prediction accordingly.

--- Processing Key Frame: c4b8c55ceed44c7e95c36e61b8a99ffe ---
[-12.974952697753906, -3.7473440170288086, -9.42955493927002, -2.1127095222473145, -13.560074806213379, -19.22380256652832, -18.96980857849121, -11.97087574005127, -7.513204574584961, -13.192395210266113, -8.257776260375977, -3.8154659271240234, -11.051424980163574, -16.106361389160156, -23.92006492614746, -2.8463990688323975, -7.6856465339660645, -7.028541088104248, -12.624686241149902, -10.900094032287598, -8.14853572845459, -16.0974178314209, -21.72966194152832, -18.944061279296875, -1.9219655990600586, -14.679315567016602, -19.908842086791992, -14.655899047851562, -7.785204887390137]
Model Output: The driving scene appears to be on an urban side street. There are two vehicles parked on the right side of the road, which appear to be standard cars. One car is closer to the camera than the other. On the left side of the road, there is a truck parked slightly behind the cars. 

No pedestrians or traffic lights are visible in these cameras. The road looks deserted, no other traffic around. 

Prediction of driver behavior for these cameras: 
- CAM_FRONT: Straight and no turning as there are no oncoming vehicles or pedestrians.
- CAM_FRONT_LEFT: Straight, observing the right side of traffic rules.
- CAM_FRONT_RIGHT: Straight, observing the right side of traffic rules.
- CAM_BACK: Straight, observing the left side of traffic rules.
- CAM_BACK_LEFT: Straight and no turning as there are no oncoming vehicles or pedestrians.
- CAM_BACK_RIGHT: Straight, observing the left side of traffic rules.

Overall, the driver from these cameras would be driving carefully and cautiously, stopping at the intersection only if it's required and adhering to traffic rules. Since it appears to be a quiet road with no need to stop, the driver would likely continue driving straight through these positions.

Resetting model state for new scene: 41fde20fedcd4d22ab26811688612870
===== Processing Scene: 41fde20fedcd4d22ab26811688612870 =====
--- Processing Key Frame: 23e7d17b256348638af3b2739b80a5ca ---
Model Output: The driving scene appears to be on a two-lane road with a clear view of the road ahead. There are no visible obstacles, such as parked cars or pedestrians, in the immediate vicinity. The traffic lights are not visible in the images provided.

The ego vehicle is currently on the right side of the road, moving in the same direction as the traffic flow. The road ahead seems to be clear, and there are no other vehicles or pedestrians visible in the images.

Given the absence of obstacles and the clear view of the road ahead, the ego vehicle should continue driving straight at its current speed. The driving speed appears to be normal, and there is no need to slow down or change direction.

--- Processing Key Frame: 2c1f8867c60b44f09ee37b5df1d1ad24 ---
[-25.35348129272461, -17.661697387695312, -13.611353874206543, -12.19803237915039, -18.98187255859375, -15.65546703338623, -12.934636116027832, -13.473777770996094, -11.146389961242676, -17.664247512817383, -19.14716339111328, -18.44294548034668, -12.319669723510742, -12.082721710205078, -11.051321029663086, -9.66707992553711, -12.069890022277832, -13.044856071472168, -10.497852325439453, -13.044150352478027, -10.08773422241211, -16.444225311279297]
Model Output: Driving Scene:
The ego vehicle is at an intersection on Wessex Rd. There is a large tree on the left side and a tall building renovated in an earthy tone in the background on the right. The road is well-paved with no visible high-registered vehicles. The surroundings include a clear sky, bushes, and fencing.

: Vehicle Behavior Prediction:
Given the current view from the car's front, the ego vehicle needs to prepare to turn right onto Wessex Rd to continue its journey. The truck behind appears to be following, proceeding at or near the ego vehicle's pace one lane behind. The pedestrians seem safe, and no traffic lights are in view from this angle. Slow down to turn right, ensuring you give right-of-way to vehicles already at the intersection.

--- Processing Key Frame: 4de7963785f34de7afb9e5aae3ce6f9f ---
[-2.797281503677368, -13.223057746887207, -11.844246864318848, -18.449525833129883, -18.361587524414062, -13.030905723571777, -3.343064069747925, -8.744129180908203, -15.40299129486084, -20.05780601501465, -17.075122833251953, -8.038074493408203, -9.131082534790039, -4.084613800048828, -7.685268402099609, -9.919693946838379, -16.27633285522461, -22.26814079284668, -10.97776985168457, -11.754093170166016, -13.44725513458252, -8.650920867919922]
Model Output: The view from the car's front-left camera shows a three-lane wide road with a medium-sized orange bus entering the street from the right lane. There are stop signs posted at the corner indicating right turns are permitted. The middle lane is currently no-through, with a gray road sign showing the lane's status. There are no visible obstacles, the sky overhead is slightly overcast, and the road surface appears dry.

Behavior predictions:
- Ego vehicle: The ego vehicle is approaching the intersection from the left lane. If no other vehicles are turning or stopping, the ego vehicle should observe the pedestrian crossing signals and obey them. If the bus veers unexpectedly into the left or middle lane, the ego vehicle may need to adjust lanes and be prepared to slow down or stop upon stopping the bus or waiting to clear an obstruction.

The view from the back camera does not provide enough information about upcoming driving conditions, such as speed limits, road hazards, or other road users, to include in the driving plan. However, without further information, it is safe to assume the ego vehicle will continue on its current path and follow route planning based on the view from the front-left camera.

--- Processing Key Frame: a32eb5c0d8514895af2af5889c1f5199 ---
[-10.788108825683594, -11.063638687133789, -12.056217193603516, -9.062714576721191, -8.81422233581543, -13.364928245544434, -14.835562705993652, -16.765626907348633, -13.3082275390625, -11.314518928527832, -14.97039794921875, -5.477185249328613, -12.249268531799316, -9.581189155578613, -13.05511474609375, -13.703910827636719, -18.887659072875977, -0.19484162330627441, -9.268403053283691, -11.117578506469727, -8.362265586853027, -12.781061172485352, -8.4390230178833, -13.54714584350586, -28.063037872314453, -1.2819615602493286, -15.133639335632324, -10.175307273864746, -11.748143196105957, -8.483244895935059, -11.4949369430542, -7.613461971282959, -5.665074825286865, -17.354930877685547, -20.421876907348633]
Model Output: The driving scene features a single-lane road that is upcoming. At the intersection, there is one way sign indicating a turn right ahead. Single vehicles are currently visible at the intersection, suggesting the traffic flow is relatively calm at this time.

The front camera view shows off-road vehicles in the background, suggesting that the direction visible is to the left. The left lane seems to be clear, while the right lane appears to have obstacles, specifically trees and foliage, limiting visibility.

The back camera view shows trees lining both sides of the road, and further back, there's a building on the right side suggesting this might be an urban or semi-urban area.

With the key factors for driving planning, the road is clear with the exception of the trees along the right side, the road curve ahead, and one-way traffic at the intersection.

Based on the available information for decision-making, the ego vehicle should proceed according to the one-way sign's direction at a safe and appropriate speed. At the curve, the driver should adjust their speed according to the road condition and visibility requirements.

For turns and path, the vehicle should follow the one-way sign's direction (turn right). Speed should be adjusted accordingly to maintain safety as the visibility seems to be good.

Resetting model state for new scene: 1aa633b683174280b243e0a9a7ad9171
===== Processing Scene: 1aa633b683174280b243e0a9a7ad9171 =====
--- Processing Key Frame: 0791e7e86b98473795eeffe238d6c13b ---
Model Output: The driving scene appears to be a quiet, suburban street with a clear view of the road ahead. There are no visible obstacles, such as parked cars or pedestrians, that would require immediate attention. The traffic lights are not visible in the images provided.

The ego vehicle is currently moving straight ahead, as indicated by the front camera's view. There are no other vehicles or pedestrians visible in the immediate vicinity, suggesting that the ego vehicle has the road to itself.

Given the absence of any immediate hazards or obstacles, the ego vehicle can continue driving at a normal speed without any need to slow down or change direction. The road ahead appears to be clear and open, allowing for a smooth and uninterrupted journey.

--- Processing Key Frame: a82c0acb18dd4c3a99731b7a06a63fb7 ---
[-25.301490783691406, -18.01423454284668, -13.94705581665039, -12.374042510986328, -19.02350616455078, -15.85364818572998, -13.163225173950195, -10.984304428100586, -11.946616172790527, -13.757916450500488, -21.590911865234375, -13.021655082702637, -11.832022666931152, -12.428523063659668, -11.157796859741211, -10.253239631652832, -12.226268768310547, -12.986066818237305, -11.66401481628418, -13.641497611999512, -9.979500770568848, -16.76763916015625]
Model Output: The scene appears calm, with clear visibility. The road is mostly clear with no vehicles other than the black sedan in motion in the foreground. There are no pedestrians visible, but four cars are parked along the side of the road. Traffic lights are not in view, so there are no indications of stop or stop-and-go traffic. The road seems to be in a suburban or subterranean area.

Predicted Ego Vehicle Behavior:
- Driving direction: Straight
- Driving speed: Fast

--- Processing Key Frame: c0ac3dc491e7414184f44c2b32d24ad8 ---
[-0.4556247591972351, -11.510042190551758, -14.459439277648926, -15.300113677978516, -12.4647855758667, -0.7817790508270264, -8.328371047973633, -6.588282585144043, -12.294426918029785]
Model Output: The driving scene includes an urban road flanked by two-story buildings. The road has a single lane in each direction, and there are trees along the sidewalk. I can see the following factors:

- **Vehicles**: There are two vehicles present in the scene: an ego vehicle in the foreground, and another car in the background on the right.
  
- **Pedestrians**: There are no visible pedestrians in the image.
  
- **Traffic Lights**: There is no visible traffic light in the image.
  
- **Obstacles**: There are no obvious obstacles along the road.

Given these parameters, the current scene is relatively clear and safe for driving.

The behavior of the ego vehicle will depend on the immediate context not visible in the photos you've provided. Based on the current image alone, the ego vehicle appears to be in the correct lane and proceeding straight. The speed of the vehicle cannot be accurately determined without additional context.

Adjusting for visual clues and presence of any vehicles or pedestrians, it is appropriate to proceed straight likely due to clear lane and no turn signs in the area which require to change lanes. Rest won't change due to!!Thank you for the images.

--- Processing Key Frame: d21bdffbca9f4edaa4bf4f54fffa6f4b ---
[-0.4061529338359833, -6.893857002258301, -1.8485301733016968, -18.336015701293945, -13.497450828552246, -7.601644039154053, -11.883930206298828, -15.189875602722168, -19.574167251586914, -21.601593017578125, -13.086140632629395, -15.618300437927246, -14.364249229431152, -13.297183990478516, -16.825695037841797, -13.020600318908691]
Model Output: The driving scene captured through the front-right camera of the vehicle shows a long straight road leading towards the front of a commercial building with multiple entrances. There are no major obstacles in the immediate surroundings such as signals or vehicles, and it appears to be a clear path to travel. Traffic is light, with a few cars scattered in the distance down the road.

In terms of key factors for driving planning:
- Obstacles: The road appears clear except for some distant trees.
- Vehicles: Only a few cars are visible ahead, none are parked except for a single car to the left of the frame.
- Pedestrians: A lone pedestrian can be observed crossing the road from the left, indicating that the traffic light or pedestrian signals are in view but are not immediately evident in the image.
- Traffic lights and signals: There are no visible traffic lights in this segment of the road; however, the pedestrian signal suggests that there is a pedestrian crossing point ahead.

Due to the nature of the pictures and the limited visibility, predicting vehicle behavior, such as exact driving direction (straight, turn left or turn right), driving speed (slow, fast or normal), braking assumptions, or detailed maneuvers of other road users, is not possible from this information alone.

--- Processing Key Frame: e42c40288fba48e993507ce35215a7d5 ---
[-13.043758392333984, -0.9875757694244385, -2.752034902572632, -7.307995796203613, -2.378098726272583, -16.61353302001953, -7.728247165679932, -11.506986618041992, -6.533870697021484, -15.180734634399414, -11.577225685119629, -14.065686225891113, -7.11371374130249, -12.093960762023926, -10.07160472869873, -17.961889266967773, -11.459033966064453, -11.73547077178955, -4.02626371383667, -3.4852919578552246, -11.787805557250977, -8.483806610107422, -7.449918270111084, -11.683262825012207, -12.935736656188965, -9.06797981262207, -10.325898170471191, -1.437994360923767, -11.842877388000488, -12.246240615844727, -9.202402114868164, -20.80518341064453, -20.128938674926758, -25.371095657348633]
Model Output: The scene in these images suggests a bustling city environment. There are multiple visible vehicles, including a red SUV prominently captured in the front-right perspective and smaller cars in the side views. There is an orange construction barrier visible on the side of the road which implies reduced speed limits or changes of course might be necessary.

The speed and direction for the red SUV should be considered. Based on the back-right perspective, it appears to be slowing down, potentially preparing to either turn left or make a stop. The back-left image suggests it might be coming from a parking area or perhaps a broad parking lot, and a right turn might have been executed. The driver’s most recent direction should follow from the back-right perspective.

The front perspective has a larger frame allowing more context but fewer details specific to the car's immediate actions. If this image is captured while the car is in motion and approaching the barrier, evaluating the precise moment before the obstacle is paramount for driving planning.

Please provide the exact moment captured by each camera toPredict the behavior of the ego vehicle with just alerting to turn left, turn right or straight.

Best,
Algorithm

Reached the limit of 3 scenes. Stopping.